<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 700" width="1200" height="700">
  <defs>
    <linearGradient id="bgGrad2" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#1a1a2e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#16213e;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow2">
      <feDropShadow dx="0" dy="4" stdDeviation="6" flood-color="#000" flood-opacity="0.4"/>
    </filter>
  </defs>
  
  <rect width="1200" height="700" fill="url(#bgGrad2)"/>
  
  <!-- Title -->
  <text x="600" y="45" text-anchor="middle" font-family="Arial, sans-serif" font-size="26" font-weight="bold" fill="#00ffa3">
    Smart Money Concepts (SMC) Detection Logic
  </text>
  <text x="600" y="70" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#9aa9b3">
    Fair Value Gaps (FVG) and Order Block (OB) Identification
  </text>

  <!-- FVG SECTION -->
  <g id="fvg-section" transform="translate(50, 100)">
    <rect x="0" y="0" width="530" height="280" rx="15" fill="#0f3460" stroke="#00ffa3" stroke-width="2" filter="url(#shadow2)"/>
    <text x="265" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#00ffa3">
      Fair Value Gap (FVG) Detection
    </text>
    
    <!-- Bullish FVG -->
    <g transform="translate(30, 50)">
      <text x="110" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#4ade80">Bullish FVG</text>
      
      <!-- Candle t-2 -->
      <rect x="30" y="40" width="30" height="80" fill="#4ade80" rx="2"/>
      <line x1="45" y1="30" x2="45" y2="40" stroke="#4ade80" stroke-width="2"/>
      <line x1="45" y1="120" x2="45" y2="135" stroke="#4ade80" stroke-width="2"/>
      <text x="45" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#9aa9b3">Candle t-2</text>
      
      <!-- Gap Zone -->
      <rect x="70" y="105" width="80" height="25" fill="rgba(0,255,163,0.2)" stroke="#00ffa3" stroke-width="1" stroke-dasharray="4"/>
      <text x="110" y="122" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#00ffa3">GAP</text>
      
      <!-- Candle t -->
      <rect x="160" y="130" width="30" height="60" fill="#4ade80" rx="2"/>
      <line x1="175" y1="110" x2="175" y2="130" stroke="#4ade80" stroke-width="2"/>
      <line x1="175" y1="190" x2="175" y2="210" stroke="#4ade80" stroke-width="2"/>
      <text x="175" y="225" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#9aa9b3">Candle t</text>
      
      <!-- Arrows -->
      <path d="M 60,120 L 60,130 L 70,125 Z" fill="#00ffa3"/>
      <text x="60" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#9aa9b3">Low(t-2)</text>
      
      <path d="M 150,115 L 150,125 L 160,120 Z" fill="#00ffa3"/>
      <text x="145" y="108" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#9aa9b3">High(t)</text>
    </g>
    
    <!-- Bearish FVG -->
    <g transform="translate(280, 50)">
      <text x="110" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#ff6b6b">Bearish FVG</text>
      
      <!-- Candle t-2 -->
      <rect x="30" y="100" width="30" height="80" fill="#ff6b6b" rx="2"/>
      <line x1="45" y1="80" x2="45" y2="100" stroke="#ff6b6b" stroke-width="2"/>
      <line x1="45" y1="180" x2="45" y2="200" stroke="#ff6b6b" stroke-width="2"/>
      <text x="45" y="215" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#9aa9b3">Candle t-2</text>
      
      <!-- Gap Zone -->
      <rect x="70" y="55" width="80" height="25" fill="rgba(255,107,107,0.2)" stroke="#ff6b6b" stroke-width="1" stroke-dasharray="4"/>
      <text x="110" y="72" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ff6b6b">GAP</text>
      
      <!-- Candle t -->
      <rect x="160" y="30" width="30" height="60" fill="#ff6b6b" rx="2"/>
      <line x1="175" y1="10" x2="175" y2="30" stroke="#ff6b6b" stroke-width="2"/>
      <line x1="175" y1="90" x2="175" y2="105" stroke="#ff6b6b" stroke-width="2"/>
      <text x="175" y="120" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#9aa9b3">Candle t</text>
    </g>
    
    <!-- Conditions -->
    <text x="140" y="250" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#4ade80">
      Low(t-2) &gt; High(t)
    </text>
    <text x="390" y="250" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#ff6b6b">
      High(t-2) &lt; Low(t)
    </text>
  </g>

  <!-- ORDER BLOCK SECTION -->
  <g id="ob-section" transform="translate(620, 100)">
    <rect x="0" y="0" width="530" height="280" rx="15" fill="#0f3460" stroke="#00ffa3" stroke-width="2" filter="url(#shadow2)"/>
    <text x="265" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#00ffa3">
      Order Block (OB) Detection
    </text>
    
    <!-- Bullish Order Block -->
    <g transform="translate(30, 50)">
      <text x="230" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#4ade80">Bullish Order Block</text>
      
      <!-- Candle t-1 (Red/Bearish) -->
      <rect x="80" y="60" width="60" height="100" fill="#ff6b6b" rx="3"/>
      <line x1="110" y1="40" x2="110" y2="60" stroke="#ff6b6b" stroke-width="3"/>
      <line x1="110" y1="160" x2="110" y2="185" stroke="#ff6b6b" stroke-width="3"/>
      <text x="110" y="200" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#9aa9b3">Candle t-1</text>
      <text x="110" y="215" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#ff6b6b">(Bearish)</text>
      
      <!-- Body Size Indicator -->
      <line x1="150" y1="60" x2="170" y2="60" stroke="#fbbf24" stroke-width="2"/>
      <line x1="150" y1="160" x2="170" y2="160" stroke="#fbbf24" stroke-width="2"/>
      <line x1="170" y1="60" x2="170" y2="160" stroke="#fbbf24" stroke-width="2"/>
      <text x="210" y="110" text-anchor="start" font-family="Arial, sans-serif" font-size="10" fill="#fbbf24">Body &gt; 1.5×ATR</text>
      <text x="210" y="125" text-anchor="start" font-family="Arial, sans-serif" font-size="9" fill="#9aa9b3">(Institutional Activity)</text>
      
      <!-- OB Level -->
      <line x1="50" y1="160" x2="460" y2="160" stroke="#00ffa3" stroke-width="2" stroke-dasharray="8,4"/>
      <text x="350" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#00ffa3">OB_BUY Level (Low of t-1)</text>
      
      <!-- Candle t (Green/Bullish) -->
      <rect x="320" y="70" width="60" height="90" fill="#4ade80" rx="3"/>
      <line x1="350" y1="50" x2="350" y2="70" stroke="#4ade80" stroke-width="3"/>
      <line x1="350" y1="160" x2="350" y2="180" stroke="#4ade80" stroke-width="3"/>
      <text x="350" y="200" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#9aa9b3">Candle t</text>
      <text x="350" y="215" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#4ade80">(Bullish)</text>
      
      <!-- Arrow showing reversal -->
      <path d="M 200,110 C 230,80 260,80 290,100" stroke="#00ffa3" stroke-width="2" fill="none" marker-end="url(#arrowhead2)"/>
    </g>
  </g>
  
  <!-- Arrow marker -->
  <defs>
    <marker id="arrowhead2" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#00ffa3"/>
    </marker>
  </defs>

  <!-- FORMULA SECTION -->
  <g id="formulas" transform="translate(50, 420)">
    <rect x="0" y="0" width="1100" height="250" rx="15" fill="#0f3460" stroke="#00ffa3" stroke-width="2" filter="url(#shadow2)"/>
    <text x="550" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#00ffa3">
      Implementation Formulas
    </text>
    
    <!-- FVG Formula -->
    <g transform="translate(50, 50)">
      <text x="0" y="20" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#4ade80">Fair Value Gap Detection:</text>
      <text x="0" y="45" font-family="Courier New, monospace" font-size="12" fill="#e0e0e0">
        FVG_BULLISH = (df['Low'].shift(2) &gt; df['High']).astype(int)
      </text>
      <text x="0" y="65" font-family="Courier New, monospace" font-size="12" fill="#e0e0e0">
        FVG_BEARISH = (df['High'].shift(2) &lt; df['Low']).astype(int)
      </text>
    </g>
    
    <!-- OB Formula -->
    <g transform="translate(50, 110)">
      <text x="0" y="20" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#f472b6">Order Block Detection:</text>
      <text x="0" y="45" font-family="Courier New, monospace" font-size="12" fill="#e0e0e0">
        is_red_c1    = df['Close'].shift(1) &lt; df['Open'].shift(1)
      </text>
      <text x="0" y="65" font-family="Courier New, monospace" font-size="12" fill="#e0e0e0">
        is_green_c2  = df['Close'] &gt; df['Open']
      </text>
      <text x="0" y="85" font-family="Courier New, monospace" font-size="12" fill="#e0e0e0">
        is_impulsive = df['BODY_SIZE'].shift(1) &gt; (1.5 × ATR)
      </text>
      <text x="0" y="105" font-family="Courier New, monospace" font-size="12" fill="#e0e0e0">
        OB_BUY       = df['Low'].shift(1) WHERE all conditions TRUE
      </text>
    </g>
    
    <!-- Key Insight -->
    <g transform="translate(650, 50)">
      <rect x="0" y="0" width="400" height="170" rx="10" fill="#1a1a2e" stroke="#fbbf24" stroke-width="1"/>
      <text x="200" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#fbbf24">Key Insight</text>
      <text x="20" y="55" font-family="Arial, sans-serif" font-size="12" fill="#9aa9b3">• Order Blocks represent areas where</text>
      <text x="20" y="75" font-family="Arial, sans-serif" font-size="12" fill="#9aa9b3">  institutional traders accumulated positions</text>
      <text x="20" y="100" font-family="Arial, sans-serif" font-size="12" fill="#9aa9b3">• FVGs indicate price inefficiencies from</text>
      <text x="20" y="120" font-family="Arial, sans-serif" font-size="12" fill="#9aa9b3">  imbalanced order flow</text>
      <text x="20" y="145" font-family="Arial, sans-serif" font-size="12" fill="#9aa9b3">• Both serve as support/resistance zones</text>
      <text x="20" y="165" font-family="Arial, sans-serif" font-size="12" fill="#9aa9b3">  for SL/TP placement</text>
    </g>
  </g>
</svg>
